"use strict";

// Lock scroll on body
var lockScroll = function lockScroll() {
  document.body.classList.toggle("js-lock");

  if (!document.body.classList.contains("js-lock")) {
    document.body.toggleAttribute("class");
  } else {
    null;
  }
}; // Click on overlay


var overlay = document.querySelector(".overlay");
var form = document.querySelector("#form");
overlay === null || overlay === void 0 ? void 0 : overlay.addEventListener("click", function () {
  var formFieldInput = document.querySelectorAll(".form__field input");
  var formFieldLabel = document.querySelectorAll(".js-invalid-label");

  for (var i = 0; i < formFieldInput.length; i++) {
    formFieldInput[i].classList.remove('js-invalid');
  }

  for (var _i = 0; _i < formFieldLabel.length; _i++) {
    formFieldLabel[_i].remove();
  }

  modalToggleVisible();
}); // Custom switch button

var switchLabel = document.querySelectorAll(".switch__label");
switchLabel === null || switchLabel === void 0 ? void 0 : switchLabel.forEach(function (e) {
  e.addEventListener("click", function () {
    if (e.querySelector("input").checked) {
      e.classList.add("js-toggle");
    } else {
      e.classList.remove("js-toggle");
    }
  });
}); // Custom counter

var counterItem = document.querySelectorAll(".counter__item");
counterItem === null || counterItem === void 0 ? void 0 : counterItem.forEach(function (e) {
  var counterInput = e.querySelector(".counter__input");
  var counterPlus = e.querySelector(".counter__plus");
  var counterMinus = e.querySelector(".counter__minus");
  var counterMax = parseInt(counterInput.getAttribute("max"));
  var counterMin = parseInt(counterInput.getAttribute("min"));
  counterPlus.addEventListener("click", function () {
    if (counterInput.value >= counterMax) {
      counterInput.value = counterMax;
    } else {
      counterInput.value++;
      counterInput.setAttribute("value", counterInput.value);
    }
  });
  counterMinus.addEventListener("click", function () {
    if (counterInput.value <= counterMin) {
      counterInput.value = counterMin;
    } else {
      counterInput.value--;
      counterInput.setAttribute("value", counterInput.value);
    }
  });
  counterInput.addEventListener("keyup", function () {
    if (counterInput.value >= counterMax) {
      counterInput.value = counterMax;
    } else if (counterInput.value <= counterMin) {
      counterInput.value = counterMin;
    } else {
      null;
    }
  });
}); // Open menu on click to Burger

var burger = document.querySelector(".burger");
var header = document.querySelector(".header");
burger.addEventListener("click", function () {
  header.classList.toggle("js-nav-open");
  lockScroll();
}); // Video

var video = document.querySelector(".video__item");
var videoPlayButton = document.querySelector(".video__play");
var videoPreview = document.querySelector(".video__preview");
videoPlayButton === null || videoPlayButton === void 0 ? void 0 : videoPlayButton.addEventListener("click", function () {
  video.style.display = "block";
  videoPlayButton.style.display = "none";
}); // Modal

var modalTrigger = document.querySelectorAll(".modal-trigger");
var modalWindow = document.querySelector(".modal");
modalTrigger === null || modalTrigger === void 0 ? void 0 : modalTrigger.forEach(function (e) {
  e.addEventListener("click", function () {
    modalToggleVisible();
  });
});

var modalToggleVisible = function modalToggleVisible() {
  modalWindow.classList.toggle("js-show");
  overlay.classList.toggle("js-show");
  lockScroll();
  setTimeout(function () {
    modalWindow.classList.remove("js-submit");
  }, 300);
}; // Validate form


if (document.querySelector("#form")) {
  var validationForm = new JustValidate("#form", {
    errorFieldCssClass: "js-invalid",
    errorLabelCssClass: "js-invalid-label",
    lockForm: true,
    errorLabelStyle: {
      textDecoration: "underlined"
    }
  });
  validationForm.addField("#user_name", [{
    rule: "minLength",
    value: 3,
    errorMessage: "Minimum 3 characters required"
  }, {
    rule: "required",
    errorMessage: "Name is required"
  }]).addField("#user_email", [{
    rule: "required",
    errorMessage: "Email is required"
  }, {
    rule: "email",
    errorMessage: "Email is invalid"
  }]).onSuccess(function (e) {
    e.preventDefault();

    if (modalWindow) {
      modalWindow.classList.add("js-submit");
    } else {
      window.location.href = 'thanks.html';
    }
  });

  if (document.querySelector("#user_company")) {
    validationForm.addField("#user_company", [{
      rule: "required",
      errorMessage: "Company is required"
    }]);
  }

  ;
}

; // Dropdown"s

if (!Element.prototype.closest) {
  if (!Element.prototype.matches) {
    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
  }

  ;

  Element.prototype.closest = function (s) {
    var el = this;
    var ancestor = this;
    if (!document.documentElement.contains(el)) return null;

    do {
      if (ancestor.matches(s)) return ancestor;
      ancestor = ancestor.parentElement;
    } while (ancestor !== null);

    return null;
  };
}

;

function closeOpenNavs() {
  var openDrops = document.querySelectorAll(".dropdown__trigger");

  for (var i = 0; i < openDrops.length; i++) {
    var openDropdown = openDrops[i];

    if (openDropdown.parentElement.classList.contains("js-open")) {
      openDropdown.parentElement.classList.remove("js-open");
    }

    ;
  }

  ;
}

;
document.addEventListener("click", function (event) {
  if (!event.target.closest(".dropdown__trigger")) {
    closeOpenNavs();
  } else if (event.target.closest(".dropdown__trigger") && event.target.parentElement.closest(".js-open")) {
    event.target.closest(".dropdown__trigger").parentElement.classList.remove("js-open");
  } else if (event.target.closest(".dropdown__trigger")) {
    closeOpenNavs();
    event.target.closest(".dropdown__trigger").parentElement.classList.add("js-open");
  }
}, false); // Plan slider

var planSlider = new Swiper(".plan__slider", {
  loop: false,
  slidesPerView: 1,
  spaceBetween: 30,
  speed: 300,
  breakpoints: {
    768: {
      slidesPerView: 2
    },
    1200: {
      slidesPerView: 3
    }
  },
  pagination: {
    el: ".plan__pagination"
  },
  navigation: {
    nextEl: ".plan__button-next",
    prevEl: ".plan__button-prev"
  }
});

if (window.matchMedia("(min-width: 992px)").matches) {
  // Custom scrollbar
  // document.addEventListener("DOMContentLoaded", function() {
  //   OverlayScrollbars(document.querySelectorAll("body"), { });
  // });
  var fixedElem = document.querySelector('.fixed-scroll');
  var scrollbar = Scrollbar.init(document.querySelector('.scroll-container'), options);
  var options = {
    damping: 0.1
  };
  scrollbar.addListener(function (status) {
    var offset = status.offset;
    fixedElem.style.top = offset.y + 'px';
    fixedElem.style.left = offset.x + 'px';
  });
} else {
  // Benefits slider
  var benefitsSlider = new Swiper(".benefits__slider", {
    loop: false,
    slidesPerView: 1,
    spaceBetween: 30,
    speed: 300,
    breakpoints: {
      768: {
        slidesPerView: 2
      }
    },
    pagination: {
      el: ".benefits__pagination"
    },
    navigation: {
      nextEl: ".benefits__button-next",
      prevEl: ".benefits__button-prev"
    }
  });
}

;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibG9ja1Njcm9sbCIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNvbnRhaW5zIiwidG9nZ2xlQXR0cmlidXRlIiwib3ZlcmxheSIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JtIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvcm1GaWVsZElucHV0IiwicXVlcnlTZWxlY3RvckFsbCIsImZvcm1GaWVsZExhYmVsIiwiaSIsImxlbmd0aCIsInJlbW92ZSIsIm1vZGFsVG9nZ2xlVmlzaWJsZSIsInN3aXRjaExhYmVsIiwiZm9yRWFjaCIsImUiLCJjaGVja2VkIiwiYWRkIiwiY291bnRlckl0ZW0iLCJjb3VudGVySW5wdXQiLCJjb3VudGVyUGx1cyIsImNvdW50ZXJNaW51cyIsImNvdW50ZXJNYXgiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsImNvdW50ZXJNaW4iLCJ2YWx1ZSIsInNldEF0dHJpYnV0ZSIsImJ1cmdlciIsImhlYWRlciIsInZpZGVvIiwidmlkZW9QbGF5QnV0dG9uIiwidmlkZW9QcmV2aWV3Iiwic3R5bGUiLCJkaXNwbGF5IiwibW9kYWxUcmlnZ2VyIiwibW9kYWxXaW5kb3ciLCJzZXRUaW1lb3V0IiwidmFsaWRhdGlvbkZvcm0iLCJKdXN0VmFsaWRhdGUiLCJlcnJvckZpZWxkQ3NzQ2xhc3MiLCJlcnJvckxhYmVsQ3NzQ2xhc3MiLCJsb2NrRm9ybSIsImVycm9yTGFiZWxTdHlsZSIsInRleHREZWNvcmF0aW9uIiwiYWRkRmllbGQiLCJydWxlIiwiZXJyb3JNZXNzYWdlIiwib25TdWNjZXNzIiwicHJldmVudERlZmF1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJFbGVtZW50IiwicHJvdG90eXBlIiwiY2xvc2VzdCIsIm1hdGNoZXMiLCJtc01hdGNoZXNTZWxlY3RvciIsIndlYmtpdE1hdGNoZXNTZWxlY3RvciIsInMiLCJlbCIsImFuY2VzdG9yIiwiZG9jdW1lbnRFbGVtZW50IiwicGFyZW50RWxlbWVudCIsImNsb3NlT3Blbk5hdnMiLCJvcGVuRHJvcHMiLCJvcGVuRHJvcGRvd24iLCJldmVudCIsInRhcmdldCIsInBsYW5TbGlkZXIiLCJTd2lwZXIiLCJsb29wIiwic2xpZGVzUGVyVmlldyIsInNwYWNlQmV0d2VlbiIsInNwZWVkIiwiYnJlYWtwb2ludHMiLCJwYWdpbmF0aW9uIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInByZXZFbCIsIm1hdGNoTWVkaWEiLCJmaXhlZEVsZW0iLCJzY3JvbGxiYXIiLCJTY3JvbGxiYXIiLCJpbml0Iiwib3B0aW9ucyIsImRhbXBpbmciLCJhZGRMaXN0ZW5lciIsInN0YXR1cyIsIm9mZnNldCIsInRvcCIsInkiLCJsZWZ0IiwieCIsImJlbmVmaXRzU2xpZGVyIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0EsSUFBTUEsVUFBVSxHQUFHLFNBQWJBLFVBQWEsR0FBTTtBQUN2QkMsRUFBQUEsUUFBUSxDQUFDQyxJQUFULENBQWNDLFNBQWQsQ0FBd0JDLE1BQXhCLENBQStCLFNBQS9COztBQUNBLE1BQUksQ0FBQ0gsUUFBUSxDQUFDQyxJQUFULENBQWNDLFNBQWQsQ0FBd0JFLFFBQXhCLENBQWlDLFNBQWpDLENBQUwsRUFBa0Q7QUFDaERKLElBQUFBLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjSSxlQUFkLENBQThCLE9BQTlCO0FBQ0QsR0FGRCxNQUVPO0FBQ0w7QUFDRDtBQUNGLENBUEQsQyxDQVNBOzs7QUFDQSxJQUFJQyxPQUFPLEdBQUdOLFFBQVEsQ0FBQ08sYUFBVCxDQUF1QixVQUF2QixDQUFkO0FBQ0EsSUFBSUMsSUFBSSxHQUFHUixRQUFRLENBQUNPLGFBQVQsQ0FBdUIsT0FBdkIsQ0FBWDtBQUVBRCxPQUFPLFNBQVAsSUFBQUEsT0FBTyxXQUFQLFlBQUFBLE9BQU8sQ0FBRUcsZ0JBQVQsQ0FBMEIsT0FBMUIsRUFBbUMsWUFBTTtBQUN2QyxNQUFJQyxjQUFjLEdBQUdWLFFBQVEsQ0FBQ1csZ0JBQVQsQ0FBMEIsb0JBQTFCLENBQXJCO0FBQ0Es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V0FBSztBQUNISCxRQUFBQSxhQUFhLEVBQUU7QUFEWjtBQURNLEtBTHdDO0FBV3JESSxJQUFBQSxVQUFVLEVBQUU7QUFDVmhCLE1BQUFBLEVBQUUsRUFBRTtBQURNLEtBWHlDO0FBY3JEaUIsSUFBQUEsVUFBVSxFQUFFO0FBQ1ZDLE1BQUFBLE1BQU0sRUFBRSx3QkFERTtBQUVWQyxNQUFBQSxNQUFNLEVBQUU7QUFGRTtBQWR5QyxHQUFoQyxDQUF2QjtBQW1CRDs7QUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gTG9jayBzY3JvbGwgb24gYm9keVxyXG5jb25zdCBsb2NrU2Nyb2xsID0gKCkgPT4ge1xyXG4gIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZShcImpzLWxvY2tcIik7XHJcbiAgaWYgKCFkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucyhcImpzLWxvY2tcIikpIHtcclxuICAgIGRvY3VtZW50LmJvZHkudG9nZ2xlQXR0cmlidXRlKFwiY2xhc3NcIik7XHJcbiAgfSBlbHNlIHtcclxuICAgIG51bGxcclxuICB9XHJcbn07XHJcblxyXG4vLyBDbGljayBvbiBvdmVybGF5XHJcbmxldCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpO1xyXG5sZXQgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybVwiKTtcclxuXHJcbm92ZXJsYXk/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgbGV0IGZvcm1GaWVsZElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19maWVsZCBpbnB1dFwiKTtcclxuICBsZXQgZm9ybUZpZWxkTGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmpzLWludmFsaWQtbGFiZWxcIik7XHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZm9ybUZpZWxkSW5wdXQubGVuZ3RoOyBpKyspe1xyXG4gICAgZm9ybUZpZWxkSW5wdXRbaV0uY2xhc3NMaXN0LnJlbW92ZSgnanMtaW52YWxpZCcpO1xyXG4gIH1cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcm1GaWVsZExhYmVsLmxlbmd0aDsgaSsrKXtcclxuICAgIGZvcm1GaWVsZExhYmVsW2ldLnJlbW92ZSgpO1xyXG4gIH1cclxuICBtb2RhbFRvZ2dsZVZpc2libGUoKVxyXG59KTtcclxuXHJcbi8vIEN1c3RvbSBzd2l0Y2ggYnV0dG9uXHJcbmxldCBzd2l0Y2hMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3dpdGNoX19sYWJlbFwiKTtcclxuXHJcbnN3aXRjaExhYmVsPy5mb3JFYWNoKChlKSA9PiB7XHJcbiAgZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgaWYgKGUucXVlcnlTZWxlY3RvcihcImlucHV0XCIpLmNoZWNrZWQpIHtcclxuICAgICAgZS5jbGFzc0xpc3QuYWRkKFwianMtdG9nZ2xlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZS5jbGFzc0xpc3QucmVtb3ZlKFwianMtdG9nZ2xlXCIpO1xyXG4gICAgfVxyXG4gIH0pXHJcbn0pO1xyXG5cclxuLy8gQ3VzdG9tIGNvdW50ZXJcclxubGV0IGNvdW50ZXJJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb3VudGVyX19pdGVtXCIpO1xyXG5cclxuY291bnRlckl0ZW0/LmZvckVhY2goKGUpID0+IHtcclxuICBsZXQgY291bnRlcklucHV0ID0gZS5xdWVyeVNlbGVjdG9yKFwiLmNvdW50ZXJfX2lucHV0XCIpO1xyXG4gIGxldCBjb3VudGVyUGx1cyA9IGUucXVlcnlTZWxlY3RvcihcIi5jb3VudGVyX19wbHVzXCIpO1xyXG4gIGxldCBjb3VudGVyTWludXMgPSBlLnF1ZXJ5U2VsZWN0b3IoXCIuY291bnRlcl9fbWludXNcIik7XHJcblxyXG4gIGxldCBjb3VudGVyTWF4ID0gcGFyc2VJbnQoY291bnRlcklucHV0LmdldEF0dHJpYnV0ZShcIm1heFwiKSk7XHJcbiAgbGV0IGNvdW50ZXJNaW4gPSBwYXJzZUludChjb3VudGVySW5wdXQuZ2V0QXR0cmlidXRlKFwibWluXCIpKTtcclxuXHJcbiAgY291bnRlclBsdXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGlmIChjb3VudGVySW5wdXQudmFsdWUgPj0gY291bnRlck1heCApIHtcclxuICAgICAgY291bnRlcklucHV0LnZhbHVlID0gY291bnRlck1heDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvdW50ZXJJbnB1dC52YWx1ZSsrXHJcbiAgICAgIGNvdW50ZXJJbnB1dC5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBjb3VudGVySW5wdXQudmFsdWUpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIFxyXG4gIGNvdW50ZXJNaW51cy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgaWYgKGNvdW50ZXJJbnB1dC52YWx1ZSA8PSBjb3VudGVyTWluICkge1xyXG4gICAgICBjb3VudGVySW5wdXQudmFsdWUgPSBjb3VudGVyTWluO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY291bnRlcklucHV0LnZhbHVlLS1cclxuICAgICAgY291bnRlcklucHV0LnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIGNvdW50ZXJJbnB1dC52YWx1ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvdW50ZXJJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKCkgPT4ge1xyXG4gICAgaWYgKGNvdW50ZXJJbnB1dC52YWx1ZSA+PSBjb3VudGVyTWF4KSB7XHJcbiAgICAgIGNvdW50ZXJJbnB1dC52YWx1ZSA9IGNvdW50ZXJNYXg7XHJcbiAgICB9IGVsc2UgaWYgKGNvdW50ZXJJbnB1dC52YWx1ZSA8PSBjb3VudGVyTWluKSB7XHJcbiAgICAgIGNvdW50ZXJJbnB1dC52YWx1ZSA9IGNvdW50ZXJNaW47XHJcbiAgICB9IGVsc2UgIHtcclxuICAgICAgbnVsbFxyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8vIE9wZW4gbWVudSBvbiBjbGljayB0byBCdXJnZXJcclxubGV0IGJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnVyZ2VyXCIpO1xyXG5sZXQgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJcIik7XHJcblxyXG5idXJnZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBoZWFkZXIuY2xhc3NMaXN0LnRvZ2dsZShcImpzLW5hdi1vcGVuXCIpO1xyXG4gIGxvY2tTY3JvbGwoKTtcclxufSk7XHJcblxyXG4vLyBWaWRlb1xyXG5sZXQgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpZGVvX19pdGVtXCIpO1xyXG5sZXQgdmlkZW9QbGF5QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi52aWRlb19fcGxheVwiKTtcclxubGV0IHZpZGVvUHJldmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudmlkZW9fX3ByZXZpZXdcIik7XHJcblxyXG52aWRlb1BsYXlCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgdmlkZW8uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICB2aWRlb1BsYXlCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG59KTtcclxuXHJcbi8vIE1vZGFsXHJcbmxldCBtb2RhbFRyaWdnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsLXRyaWdnZXJcIik7XHJcbmxldCBtb2RhbFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxcIik7XHJcblxyXG5tb2RhbFRyaWdnZXI/LmZvckVhY2goKGUpID0+IHtcclxuICBlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBtb2RhbFRvZ2dsZVZpc2libGUoKTtcclxuICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBtb2RhbFRvZ2dsZVZpc2libGUgPSAoKSA9PiB7XHJcbiAgbW9kYWxXaW5kb3cuY2xhc3NMaXN0LnRvZ2dsZShcImpzLXNob3dcIik7XHJcbiAgb3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKFwianMtc2hvd1wiKTtcclxuICBsb2NrU2Nyb2xsKCk7XHJcbiAgc2V0VGltZW91dCggKCkgPT4ge1xyXG4gICAgbW9kYWxXaW5kb3cuY2xhc3NMaXN0LnJlbW92ZShcImpzLXN1Ym1pdFwiKTtcclxuICB9LCAzMDApO1xyXG59O1xyXG5cclxuLy8gVmFsaWRhdGUgZm9ybVxyXG5pZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtXCIpKSB7XHJcbiAgY29uc3QgdmFsaWRhdGlvbkZvcm0gPSBuZXcgSnVzdFZhbGlkYXRlKFwiI2Zvcm1cIiwge1xyXG4gICAgZXJyb3JGaWVsZENzc0NsYXNzOiBcImpzLWludmFsaWRcIixcclxuICAgIGVycm9yTGFiZWxDc3NDbGFzczogXCJqcy1pbnZhbGlkLWxhYmVsXCIsXHJcbiAgICBsb2NrRm9ybTogdHJ1ZSxcclxuICAgIGVycm9yTGFiZWxTdHlsZToge1xyXG4gICAgICB0ZXh0RGVjb3JhdGlvbjogXCJ1bmRlcmxpbmVkXCIsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICB2YWxpZGF0aW9uRm9ybVxyXG4gICAgLmFkZEZpZWxkKFwiI3VzZXJfbmFtZVwiLCBbXHJcbiAgICAgIHtcclxuICAgICAgICBydWxlOiBcIm1pbkxlbmd0aFwiLFxyXG4gICAgICAgIHZhbHVlOiAzLFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogXCJNaW5pbXVtIDMgY2hhcmFjdGVycyByZXF1aXJlZFwiLFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgcnVsZTogXCJyZXF1aXJlZFwiLFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogXCJOYW1lIGlzIHJlcXVpcmVkXCIsXHJcbiAgICAgIH0sXHJcbiAgICBdKVxyXG4gICAgLmFkZEZpZWxkKFwiI3VzZXJfZW1haWxcIiwgW1xyXG4gICAgICB7XHJcbiAgICAgICAgcnVsZTogXCJyZXF1aXJlZFwiLFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogXCJFbWFpbCBpcyByZXF1aXJlZFwiLFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgcnVsZTogXCJlbWFpbFwiLFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogXCJFbWFpbCBpcyBpbnZhbGlkXCIsXHJcbiAgICAgIH0sXHJcbiAgICBdKVxyXG4gICAgLm9uU3VjY2VzcygoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGlmIChtb2RhbFdpbmRvdykge1xyXG4gICAgICAgIG1vZGFsV2luZG93LmNsYXNzTGlzdC5hZGQoXCJqcy1zdWJtaXRcIilcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICd0aGFua3MuaHRtbCc7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIFxyXG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3VzZXJfY29tcGFueVwiKSkge1xyXG4gICAgdmFsaWRhdGlvbkZvcm1cclxuICAgICAgLmFkZEZpZWxkKFwiI3VzZXJfY29tcGFueVwiLCBbXHJcbiAgICAgIHtcclxuICAgICAgICBydWxlOiBcInJlcXVpcmVkXCIsIFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogXCJDb21wYW55IGlzIHJlcXVpcmVkXCIsXHJcbiAgICAgIH0sXHJcbiAgICBdKVxyXG4gIH07XHJcbn07XHJcblxyXG4vLyBEcm9wZG93blwic1xyXG5pZiAoIUVsZW1lbnQucHJvdG90eXBlLmNsb3Nlc3QpIHtcclxuXHRpZiAoIUVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMpIHtcclxuXHRcdEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMgPSBFbGVtZW50LnByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3RvciB8fCBFbGVtZW50LnByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3I7XHJcblx0fTtcclxuXHRFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0ID0gZnVuY3Rpb24gKHMpIHtcclxuXHRcdHZhciBlbCA9IHRoaXM7XHJcblx0XHR2YXIgYW5jZXN0b3IgPSB0aGlzO1xyXG5cdFx0aWYgKCFkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMoZWwpKSByZXR1cm4gbnVsbDtcclxuXHRcdGRvIHtcclxuXHRcdFx0aWYgKGFuY2VzdG9yLm1hdGNoZXMocykpIHJldHVybiBhbmNlc3RvcjtcclxuXHRcdFx0YW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnRFbGVtZW50O1xyXG5cdFx0fSB3aGlsZSAoYW5jZXN0b3IgIT09IG51bGwpO1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNsb3NlT3Blbk5hdnMoKSB7XHJcbiAgdmFyIG9wZW5Ecm9wcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZHJvcGRvd25fX3RyaWdnZXJcIik7XHJcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvcGVuRHJvcHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdHZhciBvcGVuRHJvcGRvd24gPSBvcGVuRHJvcHNbaV07XHJcblx0XHRpZiAob3BlbkRyb3Bkb3duLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwianMtb3BlblwiKSkge1xyXG5cdFx0ICBvcGVuRHJvcGRvd24ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwianMtb3BlblwiKTtcclxuXHRcdH07XHJcblx0fTtcclxufTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRpZiAoIWV2ZW50LnRhcmdldC5jbG9zZXN0KFwiLmRyb3Bkb3duX190cmlnZ2VyXCIpKXtcclxuXHRcdGNsb3NlT3Blbk5hdnMoKTtcclxuXHR9IFxyXG5cdGVsc2UgaWYgKGV2ZW50LnRhcmdldC5jbG9zZXN0KFwiLmRyb3Bkb3duX190cmlnZ2VyXCIpICYmIGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoXCIuanMtb3BlblwiKSl7XHJcblx0XHRldmVudC50YXJnZXQuY2xvc2VzdChcIi5kcm9wZG93bl9fdHJpZ2dlclwiKS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJqcy1vcGVuXCIpO1xyXG5cdH1cclxuXHRlbHNlIGlmIChldmVudC50YXJnZXQuY2xvc2VzdChcIi5kcm9wZG93bl9fdHJpZ2dlclwiKSl7XHJcblx0XHRjbG9zZU9wZW5OYXZzKCk7XHJcblx0XHRldmVudC50YXJnZXQuY2xvc2VzdChcIi5kcm9wZG93bl9fdHJpZ2dlclwiKS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJqcy1vcGVuXCIpO1xyXG5cdH1cclxuXHRcclxufSwgZmFsc2UpO1xyXG5cclxuLy8gUGxhbiBzbGlkZXJcclxuY29uc3QgcGxhblNsaWRlciA9IG5ldyBTd2lwZXIoXCIucGxhbl9fc2xpZGVyXCIsIHtcclxuICBsb29wOiBmYWxzZSxcclxuICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gIHNwYWNlQmV0d2VlbjogMzAsXHJcbiAgc3BlZWQ6IDMwMCxcclxuICBicmVha3BvaW50czoge1xyXG4gICAgNzY4OiB7XHJcbiAgICAgIHNsaWRlc1BlclZpZXc6IDIsXHJcbiAgICB9LFxyXG4gICAgMTIwMDoge1xyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAzLFxyXG4gICAgfSxcclxuICB9LFxyXG5cclxuICBwYWdpbmF0aW9uOiB7XHJcbiAgICBlbDogXCIucGxhbl9fcGFnaW5hdGlvblwiLFxyXG4gIH0sXHJcbiAgbmF2aWdhdGlvbjoge1xyXG4gICAgbmV4dEVsOiBcIi5wbGFuX19idXR0b24tbmV4dFwiLFxyXG4gICAgcHJldkVsOiBcIi5wbGFuX19idXR0b24tcHJldlwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuaWYgKHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogOTkycHgpXCIpLm1hdGNoZXMpIHtcclxuICAvLyBDdXN0b20gc2Nyb2xsYmFyXHJcbiAgLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgLy8gICBPdmVybGF5U2Nyb2xsYmFycyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiYm9keVwiKSwgeyB9KTtcclxuICAvLyB9KTtcclxuICB2YXIgZml4ZWRFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZpeGVkLXNjcm9sbCcpO1xyXG5cclxuICB2YXIgc2Nyb2xsYmFyID0gU2Nyb2xsYmFyLmluaXQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjcm9sbC1jb250YWluZXInKSwgb3B0aW9ucyk7XHJcblxyXG4gIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICBkYW1waW5nOiAwLjEsXHJcbiAgfTtcclxuXHJcbiAgc2Nyb2xsYmFyLmFkZExpc3RlbmVyKGZ1bmN0aW9uKHN0YXR1cykge1xyXG4gICAgdmFyIG9mZnNldCA9IHN0YXR1cy5vZmZzZXQ7XHJcbiAgICBcclxuICAgIGZpeGVkRWxlbS5zdHlsZS50b3AgPSBvZmZzZXQueSArICdweCc7XHJcbiAgICBmaXhlZEVsZW0uc3R5bGUubGVmdCA9IG9mZnNldC54ICsgJ3B4JztcclxuICB9KTtcclxufSBlbHNlIHtcclxuICAvLyBCZW5lZml0cyBzbGlkZXJcclxuICBjb25zdCBiZW5lZml0c1NsaWRlciA9IG5ldyBTd2lwZXIoXCIuYmVuZWZpdHNfX3NsaWRlclwiLCB7XHJcbiAgICBsb29wOiBmYWxzZSxcclxuICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICBzcGFjZUJldHdlZW46IDMwLFxyXG4gICAgc3BlZWQ6IDMwMCxcclxuICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgIDc2ODoge1xyXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDIsXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgZWw6IFwiLmJlbmVmaXRzX19wYWdpbmF0aW9uXCIsXHJcbiAgICB9LFxyXG4gICAgbmF2aWdhdGlvbjoge1xyXG4gICAgICBuZXh0RWw6IFwiLmJlbmVmaXRzX19idXR0b24tbmV4dFwiLFxyXG4gICAgICBwcmV2RWw6IFwiLmJlbmVmaXRzX19idXR0b24tcHJldlwiLFxyXG4gICAgfSxcclxuICB9KTtcclxufTsiXX0=