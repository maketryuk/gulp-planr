"use strict";

// Lock scroll on body
var lockScroll = function lockScroll() {
  document.body.classList.toggle("js-lock");

  if (!document.body.classList.contains("js-lock")) {
    document.body.toggleAttribute("class");
  } else {
    null;
  }
}; // Click on overlay


var overlay = document.querySelector(".overlay");
var form = document.querySelector("#form");
overlay === null || overlay === void 0 ? void 0 : overlay.addEventListener("click", function () {
  var formFieldInput = document.querySelectorAll(".form__field input");
  var formFieldLabel = document.querySelectorAll(".js-invalid-label");

  for (var i = 0; i < formFieldInput.length; i++) {
    formFieldInput[i].classList.remove('js-invalid');
  }

  for (var _i = 0; _i < formFieldLabel.length; _i++) {
    formFieldLabel[_i].remove();
  }

  modalToggleVisible();
}); // Custom switch button

var switchLabel = document.querySelectorAll(".switch__label");
switchLabel === null || switchLabel === void 0 ? void 0 : switchLabel.forEach(function (e) {
  e.addEventListener("click", function () {
    if (e.querySelector("input").checked) {
      e.classList.add("js-toggle");
    } else {
      e.classList.remove("js-toggle");
    }
  });
}); // Custom counter

var counterItem = document.querySelectorAll(".counter__item");
counterItem === null || counterItem === void 0 ? void 0 : counterItem.forEach(function (e) {
  var counterInput = e.querySelector(".counter__input");
  var counterPlus = e.querySelector(".counter__plus");
  var counterMinus = e.querySelector(".counter__minus");
  var counterMax = parseInt(counterInput.getAttribute("max"));
  var counterMin = parseInt(counterInput.getAttribute("min"));
  counterPlus.addEventListener("click", function () {
    if (counterInput.value >= counterMax) {
      counterInput.value = counterMax;
    } else {
      counterInput.value++;
      counterInput.setAttribute("value", counterInput.value);
    }
  });
  counterMinus.addEventListener("click", function () {
    if (counterInput.value <= counterMin) {
      counterInput.value = counterMin;
    } else {
      counterInput.value--;
      counterInput.setAttribute("value", counterInput.value);
    }
  });
  counterInput.addEventListener("keyup", function () {
    if (counterInput.value >= counterMax) {
      counterInput.value = counterMax;
    } else if (counterInput.value <= counterMin) {
      counterInput.value = counterMin;
    } else {
      null;
    }
  });
}); // Open menu on click to Burger

var burger = document.querySelector(".burger");
var header = document.querySelector(".header");
burger.addEventListener("click", function () {
  header.classList.toggle("js-nav-open");
  lockScroll();
}); // Video

var video = document.querySelector(".video__item");
var videoPlayButton = document.querySelector(".video__play");
var videoPreview = document.querySelector(".video__preview");
videoPlayButton === null || videoPlayButton === void 0 ? void 0 : videoPlayButton.addEventListener("click", function () {
  video.style.display = "block";
  videoPlayButton.style.display = "none";
}); // Modal

var modalTrigger = document.querySelectorAll(".modal-trigger");
var modalWindow = document.querySelector(".modal");
modalTrigger === null || modalTrigger === void 0 ? void 0 : modalTrigger.forEach(function (e) {
  e.addEventListener("click", function () {
    modalToggleVisible();
  });
});

var modalToggleVisible = function modalToggleVisible() {
  modalWindow.classList.toggle("js-show");
  overlay.classList.toggle("js-show");
  lockScroll();
  setTimeout(function () {
    modalWindow.classList.remove("js-submit");
  }, 300);
}; // Validate form


if (document.querySelector("#form")) {
  var validationForm = new JustValidate("#form", {
    errorFieldCssClass: "js-invalid",
    errorLabelCssClass: "js-invalid-label",
    lockForm: true,
    errorLabelStyle: {
      textDecoration: "underlined"
    }
  });
  validationForm.addField("#user_name", [{
    rule: "minLength",
    value: 3,
    errorMessage: "Minimum 3 characters required"
  }, {
    rule: "required",
    errorMessage: "Name is required"
  }]).addField("#user_email", [{
    rule: "required",
    errorMessage: "Email is required"
  }, {
    rule: "email",
    errorMessage: "Email is invalid"
  }]).onSuccess(function (e) {
    e.preventDefault();

    if (modalWindow) {
      modalWindow.classList.add("js-submit");
    } else {
      if (document.documentElement.lang === "en") {
        window.location.href = 'en-thanks.html';
      } else if (document.documentElement.lang === "de") {
        window.location.href = 'thanks.html';
      }
    }
  });

  if (document.querySelector("#user_company")) {
    validationForm.addField("#user_company", [{
      rule: "required",
      errorMessage: "Company is required"
    }]);
  }

  ;
}

; // Dropdown"s

if (!Element.prototype.closest) {
  if (!Element.prototype.matches) {
    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
  }

  ;

  Element.prototype.closest = function (s) {
    var el = this;
    var ancestor = this;
    if (!document.documentElement.contains(el)) return null;

    do {
      if (ancestor.matches(s)) return ancestor;
      ancestor = ancestor.parentElement;
    } while (ancestor !== null);

    return null;
  };
}

;

function closeOpenNavs() {
  var openDrops = document.querySelectorAll(".dropdown__trigger");

  for (var i = 0; i < openDrops.length; i++) {
    var openDropdown = openDrops[i];

    if (openDropdown.parentElement.classList.contains("js-open")) {
      openDropdown.parentElement.classList.remove("js-open");
    }

    ;
  }

  ;
}

;
document.addEventListener("click", function (event) {
  if (!event.target.closest(".dropdown__trigger")) {
    closeOpenNavs();
  } else if (event.target.closest(".dropdown__trigger") && event.target.parentElement.closest(".js-open")) {
    event.target.closest(".dropdown__trigger").parentElement.classList.remove("js-open");
  } else if (event.target.closest(".dropdown__trigger")) {
    closeOpenNavs();
    event.target.closest(".dropdown__trigger").parentElement.classList.add("js-open");
  }
}, false); // Plan slider

var planSlider = new Swiper(".plan__slider", {
  loop: false,
  slidesPerView: 1,
  spaceBetween: 30,
  speed: 300,
  breakpoints: {
    768: {
      slidesPerView: 2
    },
    1200: {
      slidesPerView: 3
    }
  },
  pagination: {
    el: ".plan__pagination"
  },
  navigation: {
    nextEl: ".plan__button-next",
    prevEl: ".plan__button-prev"
  }
});

if (window.matchMedia("(min-width: 992px)").matches) {
  // Custom scrollbar
  document.addEventListener("DOMContentLoaded", function () {
    OverlayScrollbars(document.querySelectorAll("body"), {});
  });
} else {
  // Benefits slider
  var benefitsSlider = new Swiper(".benefits__slider", {
    loop: false,
    slidesPerView: 1,
    spaceBetween: 30,
    speed: 300,
    breakpoints: {
      768: {
        slidesPerView: 2
      }
    },
    pagination: {
      el: ".benefits__pagination"
    },
    navigation: {
      nextEl: ".benefits__button-next",
      prevEl: ".benefits__button-prev"
    }
  });
}

;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibG9ja1Njcm9sbCIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNvbnRhaW5zIiwidG9nZ2xlQXR0cmlidXRlIiwib3ZlcmxheSIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JtIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvcm1GaWVsZElucHV0IiwicXVlcnlTZWxlY3RvckFsbCIsImZvcm1GaWVsZExhYmVsIiwiaSIsImxlbmd0aCIsInJlbW92ZSIsIm1vZGFsVG9nZ2xlVmlzaWJsZSIsInN3aXRjaExhYmVsIiwiZm9yRWFjaCIsImUiLCJjaGVja2VkIiwiYWRkIiwiY291bnRlckl0ZW0iLCJjb3VudGVySW5wdXQiLCJjb3VudGVyUGx1cyIsImNvdW50ZXJNaW51cyIsImNvdW50ZXJNYXgiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsImNvdW50ZXJNaW4iLCJ2YWx1ZSIsInNldEF0dHJpYnV0ZSIsImJ1cmdlciIsImhlYWRlciIsInZpZGVvIiwidmlkZW9QbGF5QnV0dG9uIiwidmlkZW9QcmV2aWV3Iiwic3R5bGUiLCJkaXNwbGF5IiwibW9kYWxUcmlnZ2VyIiwibW9kYWxXaW5kb3ciLCJzZXRUaW1lb3V0IiwidmFsaWRhdGlvbkZvcm0iLCJKdXN0VmFsaWRhdGUiLCJlcnJvckZpZWxkQ3NzQ2xhc3MiLCJlcnJvckxhYmVsQ3NzQ2xhc3MiLCJsb2NrRm9ybSIsImVycm9yTGFiZWxTdHlsZSIsInRleHREZWNvcmF0aW9uIiwiYWRkRmllbGQiLCJydWxlIiwiZXJyb3JNZXNzYWdlIiwib25TdWNjZXNzIiwicHJldmVudERlZmF1bHQiLCJkb2N1bWVudEVsZW1lbnQiLCJsYW5nIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiRWxlbWVudCIsInByb3RvdHlwZSIsImNsb3Nlc3QiLCJtYXRjaGVzIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJzIiwiZWwiLCJhbmNlc3RvciIsInBhcmVudEVsZW1lbnQiLCJjbG9zZU9wZW5OYXZzIiwib3BlbkRyb3BzIiwib3BlbkRyb3Bkb3duIiwiZXZlbnQiLCJ0YXJnZXQiLCJwbGFuU2xpZGVyIiwiU3dpcGVyIiwibG9vcCIsInNsaWRlc1BlclZpZXciLCJzcGFjZUJldHdlZW4iLCJzcGVlZCIsImJyZWFrcG9pbnRzIiwicGFnaW5hdGlvbiIsIm5hdmlnYXRpb24iLCJuZXh0RWwiLCJwcmV2RWwiLCJtYXRjaE1lZGlhIiwiT3ZlcmxheVNjcm9sbGJhcnMiLCJiZW5lZml0c1NsaWRlciJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBLElBQU1BLFVBQVUsR0FBRyxTQUFiQSxVQUFhLEdBQU07QUFDdkJDLEVBQUFBLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxTQUFkLENBQXdCQyxNQUF4QixDQUErQixTQUEvQjs7QUFDQSxNQUFJLENBQUNILFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxTQUFkLENBQXdCRSxRQUF4QixDQUFpQyxTQUFqQyxDQUFMLEVBQWtEO0FBQ2hESixJQUFBQSxRQUFRLENBQUNDLElBQVQsQ0FBY0ksZUFBZCxDQUE4QixPQUE5QjtBQUNELEdBRkQsTUFFTztBQUNMO0FBQ0Q7QUFDRixDQVBELEMsQ0FTQTs7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHTixRQUFRLENBQUNPLGFBQVQsQ0FBdUIsVUFBdkIsQ0FBZDtBQUNBLElBQUlDLElBQUksR0FBR1IsUUFBUSxDQUFDTyxhQUFULENBQXVCLE9BQXZCLENBQVg7QUFFQUQsT0FBTyxTQUFQLElBQUFBLE9BQU8sV0FBUCxZQUFBQSxPQUFPLENBQUVHLGdCQUFULENBQTBCLE9BQTFCLEVBQW1DLFlBQU07QUFDdkMsTUFBSUMsY0FBYyxHQUFHVixRQUFRLENBQUNXLGdCQUFULENBQTBCLG9CQUExQixDQUFyQjtBQUNBLE1BQUlDLGNBQWMsR0FBR1osUUFBUSxDQUFDVyxnQkFBVCxDQUEwQixtQkFBMUIsQ0FBckI7O0FBRUEsT0FBSyxJQUFJRSxDQUFDLEdBQUcsQ0FBYixFQUFn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dCI6WyIvLyBMb2NrIHNjcm9sbCBvbiBib2R5XHJcbmNvbnN0IGxvY2tTY3JvbGwgPSAoKSA9PiB7XHJcbiAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKFwianMtbG9ja1wiKTtcclxuICBpZiAoIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKFwianMtbG9ja1wiKSkge1xyXG4gICAgZG9jdW1lbnQuYm9keS50b2dnbGVBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcclxuICB9IGVsc2Uge1xyXG4gICAgbnVsbFxyXG4gIH1cclxufTtcclxuXHJcbi8vIENsaWNrIG9uIG92ZXJsYXlcclxubGV0IG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlcIik7XHJcbmxldCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtXCIpO1xyXG5cclxub3ZlcmxheT8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBsZXQgZm9ybUZpZWxkSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2ZpZWxkIGlucHV0XCIpO1xyXG4gIGxldCBmb3JtRmllbGRMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuanMtaW52YWxpZC1sYWJlbFwiKTtcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBmb3JtRmllbGRJbnB1dC5sZW5ndGg7IGkrKyl7XHJcbiAgICBmb3JtRmllbGRJbnB1dFtpXS5jbGFzc0xpc3QucmVtb3ZlKCdqcy1pbnZhbGlkJyk7XHJcbiAgfVxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZm9ybUZpZWxkTGFiZWwubGVuZ3RoOyBpKyspe1xyXG4gICAgZm9ybUZpZWxkTGFiZWxbaV0ucmVtb3ZlKCk7XHJcbiAgfVxyXG4gIG1vZGFsVG9nZ2xlVmlzaWJsZSgpXHJcbn0pO1xyXG5cclxuLy8gQ3VzdG9tIHN3aXRjaCBidXR0b25cclxubGV0IHN3aXRjaExhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zd2l0Y2hfX2xhYmVsXCIpO1xyXG5cclxuc3dpdGNoTGFiZWw/LmZvckVhY2goKGUpID0+IHtcclxuICBlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBpZiAoZS5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIikuY2hlY2tlZCkge1xyXG4gICAgICBlLmNsYXNzTGlzdC5hZGQoXCJqcy10b2dnbGVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBlLmNsYXNzTGlzdC5yZW1vdmUoXCJqcy10b2dnbGVcIik7XHJcbiAgICB9XHJcbiAgfSlcclxufSk7XHJcblxyXG4vLyBDdXN0b20gY291bnRlclxyXG5sZXQgY291bnRlckl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNvdW50ZXJfX2l0ZW1cIik7XHJcblxyXG5jb3VudGVySXRlbT8uZm9yRWFjaCgoZSkgPT4ge1xyXG4gIGxldCBjb3VudGVySW5wdXQgPSBlLnF1ZXJ5U2VsZWN0b3IoXCIuY291bnRlcl9faW5wdXRcIik7XHJcbiAgbGV0IGNvdW50ZXJQbHVzID0gZS5xdWVyeVNlbGVjdG9yKFwiLmNvdW50ZXJfX3BsdXNcIik7XHJcbiAgbGV0IGNvdW50ZXJNaW51cyA9IGUucXVlcnlTZWxlY3RvcihcIi5jb3VudGVyX19taW51c1wiKTtcclxuXHJcbiAgbGV0IGNvdW50ZXJNYXggPSBwYXJzZUludChjb3VudGVySW5wdXQuZ2V0QXR0cmlidXRlKFwibWF4XCIpKTtcclxuICBsZXQgY291bnRlck1pbiA9IHBhcnNlSW50KGNvdW50ZXJJbnB1dC5nZXRBdHRyaWJ1dGUoXCJtaW5cIikpO1xyXG5cclxuICBjb3VudGVyUGx1cy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgaWYgKGNvdW50ZXJJbnB1dC52YWx1ZSA+PSBjb3VudGVyTWF4ICkge1xyXG4gICAgICBjb3VudGVySW5wdXQudmFsdWUgPSBjb3VudGVyTWF4O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY291bnRlcklucHV0LnZhbHVlKytcclxuICAgICAgY291bnRlcklucHV0LnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIGNvdW50ZXJJbnB1dC52YWx1ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgY291bnRlck1pbnVzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBpZiAoY291bnRlcklucHV0LnZhbHVlIDw9IGNvdW50ZXJNaW4gKSB7XHJcbiAgICAgIGNvdW50ZXJJbnB1dC52YWx1ZSA9IGNvdW50ZXJNaW47XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb3VudGVySW5wdXQudmFsdWUtLVxyXG4gICAgICBjb3VudGVySW5wdXQuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgY291bnRlcklucHV0LnZhbHVlKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY291bnRlcklucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoKSA9PiB7XHJcbiAgICBpZiAoY291bnRlcklucHV0LnZhbHVlID49IGNvdW50ZXJNYXgpIHtcclxuICAgICAgY291bnRlcklucHV0LnZhbHVlID0gY291bnRlck1heDtcclxuICAgIH0gZWxzZSBpZiAoY291bnRlcklucHV0LnZhbHVlIDw9IGNvdW50ZXJNaW4pIHtcclxuICAgICAgY291bnRlcklucHV0LnZhbHVlID0gY291bnRlck1pbjtcclxuICAgIH0gZWxzZSAge1xyXG4gICAgICBudWxsXHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy8gT3BlbiBtZW51IG9uIGNsaWNrIHRvIEJ1cmdlclxyXG5sZXQgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idXJnZXJcIik7XHJcbmxldCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlclwiKTtcclxuXHJcbmJ1cmdlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGhlYWRlci5jbGFzc0xpc3QudG9nZ2xlKFwianMtbmF2LW9wZW5cIik7XHJcbiAgbG9ja1Njcm9sbCgpO1xyXG59KTtcclxuXHJcbi8vIFZpZGVvXHJcbmxldCB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudmlkZW9fX2l0ZW1cIik7XHJcbmxldCB2aWRlb1BsYXlCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpZGVvX19wbGF5XCIpO1xyXG5sZXQgdmlkZW9QcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi52aWRlb19fcHJldmlld1wiKTtcclxuXHJcbnZpZGVvUGxheUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB2aWRlby5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gIHZpZGVvUGxheUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbn0pO1xyXG5cclxuLy8gTW9kYWxcclxubGV0IG1vZGFsVHJpZ2dlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWwtdHJpZ2dlclwiKTtcclxubGV0IG1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbFwiKTtcclxuXHJcbm1vZGFsVHJpZ2dlcj8uZm9yRWFjaCgoZSkgPT4ge1xyXG4gIGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG1vZGFsVG9nZ2xlVmlzaWJsZSgpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbmNvbnN0IG1vZGFsVG9nZ2xlVmlzaWJsZSA9ICgpID0+IHtcclxuICBtb2RhbFdpbmRvdy5jbGFzc0xpc3QudG9nZ2xlKFwianMtc2hvd1wiKTtcclxuICBvdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoXCJqcy1zaG93XCIpO1xyXG4gIGxvY2tTY3JvbGwoKTtcclxuICBzZXRUaW1lb3V0KCAoKSA9PiB7XHJcbiAgICBtb2RhbFdpbmRvdy5jbGFzc0xpc3QucmVtb3ZlKFwianMtc3VibWl0XCIpO1xyXG4gIH0sIDMwMCk7XHJcbn07XHJcblxyXG4vLyBWYWxpZGF0ZSBmb3JtXHJcbmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm1cIikpIHtcclxuICBjb25zdCB2YWxpZGF0aW9uRm9ybSA9IG5ldyBKdXN0VmFsaWRhdGUoXCIjZm9ybVwiLCB7XHJcbiAgICBlcnJvckZpZWxkQ3NzQ2xhc3M6IFwianMtaW52YWxpZFwiLFxyXG4gICAgZXJyb3JMYWJlbENzc0NsYXNzOiBcImpzLWludmFsaWQtbGFiZWxcIixcclxuICAgIGxvY2tGb3JtOiB0cnVlLFxyXG4gICAgZXJyb3JMYWJlbFN0eWxlOiB7XHJcbiAgICAgIHRleHREZWNvcmF0aW9uOiBcInVuZGVybGluZWRcIixcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIHZhbGlkYXRpb25Gb3JtXHJcbiAgICAuYWRkRmllbGQoXCIjdXNlcl9uYW1lXCIsIFtcclxuICAgICAge1xyXG4gICAgICAgIHJ1bGU6IFwibWluTGVuZ3RoXCIsXHJcbiAgICAgICAgdmFsdWU6IDMsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBcIk1pbmltdW0gMyBjaGFyYWN0ZXJzIHJlcXVpcmVkXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBydWxlOiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBcIk5hbWUgaXMgcmVxdWlyZWRcIixcclxuICAgICAgfSxcclxuICAgIF0pXHJcbiAgICAuYWRkRmllbGQoXCIjdXNlcl9lbWFpbFwiLCBbXHJcbiAgICAgIHtcclxuICAgICAgICBydWxlOiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBcIkVtYWlsIGlzIHJlcXVpcmVkXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBydWxlOiBcImVtYWlsXCIsXHJcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBcIkVtYWlsIGlzIGludmFsaWRcIixcclxuICAgICAgfSxcclxuICAgIF0pXHJcbiAgICAub25TdWNjZXNzKChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgaWYgKG1vZGFsV2luZG93KSB7XHJcbiAgICAgICAgbW9kYWxXaW5kb3cuY2xhc3NMaXN0LmFkZChcImpzLXN1Ym1pdFwiKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZyA9PT0gXCJlblwiKSB7XHJcbiAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICdlbi10aGFua3MuaHRtbCc7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZyA9PT0gXCJkZVwiKSB7XHJcbiAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICd0aGFua3MuaHRtbCc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICBcclxuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN1c2VyX2NvbXBhbnlcIikpIHtcclxuICAgIHZhbGlkYXRpb25Gb3JtXHJcbiAgICAgIC5hZGRGaWVsZChcIiN1c2VyX2NvbXBhbnlcIiwgW1xyXG4gICAgICB7XHJcbiAgICAgICAgcnVsZTogXCJyZXF1aXJlZFwiLCBcclxuICAgICAgICBlcnJvck1lc3NhZ2U6IFwiQ29tcGFueSBpcyByZXF1aXJlZFwiLFxyXG4gICAgICB9LFxyXG4gICAgXSlcclxuICB9O1xyXG59O1xyXG5cclxuLy8gRHJvcGRvd25cInNcclxuaWYgKCFFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0KSB7XHJcblx0aWYgKCFFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzKSB7XHJcblx0XHRFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzID0gRWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yO1xyXG5cdH07XHJcblx0RWxlbWVudC5wcm90b3R5cGUuY2xvc2VzdCA9IGZ1bmN0aW9uIChzKSB7XHJcblx0XHR2YXIgZWwgPSB0aGlzO1xyXG5cdFx0dmFyIGFuY2VzdG9yID0gdGhpcztcclxuXHRcdGlmICghZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKGVsKSkgcmV0dXJuIG51bGw7XHJcblx0XHRkbyB7XHJcblx0XHRcdGlmIChhbmNlc3Rvci5tYXRjaGVzKHMpKSByZXR1cm4gYW5jZXN0b3I7XHJcblx0XHRcdGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50RWxlbWVudDtcclxuXHRcdH0gd2hpbGUgKGFuY2VzdG9yICE9PSBudWxsKTtcclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH07XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjbG9zZU9wZW5OYXZzKCkge1xyXG4gIHZhciBvcGVuRHJvcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmRyb3Bkb3duX190cmlnZ2VyXCIpO1xyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgb3BlbkRyb3BzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgb3BlbkRyb3Bkb3duID0gb3BlbkRyb3BzW2ldO1xyXG5cdFx0aWYgKG9wZW5Ecm9wZG93bi5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcImpzLW9wZW5cIikpIHtcclxuXHRcdCAgb3BlbkRyb3Bkb3duLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImpzLW9wZW5cIik7XHJcblx0XHR9O1xyXG5cdH07XHJcbn07XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcblx0aWYgKCFldmVudC50YXJnZXQuY2xvc2VzdChcIi5kcm9wZG93bl9fdHJpZ2dlclwiKSl7XHJcblx0XHRjbG9zZU9wZW5OYXZzKCk7XHJcblx0fSBcclxuXHRlbHNlIGlmIChldmVudC50YXJnZXQuY2xvc2VzdChcIi5kcm9wZG93bl9fdHJpZ2dlclwiKSAmJiBldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5jbG9zZXN0KFwiLmpzLW9wZW5cIikpe1xyXG5cdFx0ZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCIuZHJvcGRvd25fX3RyaWdnZXJcIikucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwianMtb3BlblwiKTtcclxuXHR9XHJcblx0ZWxzZSBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCIuZHJvcGRvd25fX3RyaWdnZXJcIikpe1xyXG5cdFx0Y2xvc2VPcGVuTmF2cygpO1xyXG5cdFx0ZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCIuZHJvcGRvd25fX3RyaWdnZXJcIikucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwianMtb3BlblwiKTtcclxuXHR9XHJcblx0XHJcbn0sIGZhbHNlKTtcclxuXHJcbi8vIFBsYW4gc2xpZGVyXHJcbmNvbnN0IHBsYW5TbGlkZXIgPSBuZXcgU3dpcGVyKFwiLnBsYW5fX3NsaWRlclwiLCB7XHJcbiAgbG9vcDogZmFsc2UsXHJcbiAgc2xpZGVzUGVyVmlldzogMSxcclxuICBzcGFjZUJldHdlZW46IDMwLFxyXG4gIHNwZWVkOiAzMDAsXHJcbiAgYnJlYWtwb2ludHM6IHtcclxuICAgIDc2ODoge1xyXG4gICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgfSxcclxuICAgIDEyMDA6IHtcclxuICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgIH0sXHJcbiAgfSxcclxuXHJcbiAgcGFnaW5hdGlvbjoge1xyXG4gICAgZWw6IFwiLnBsYW5fX3BhZ2luYXRpb25cIixcclxuICB9LFxyXG4gIG5hdmlnYXRpb246IHtcclxuICAgIG5leHRFbDogXCIucGxhbl9fYnV0dG9uLW5leHRcIixcclxuICAgIHByZXZFbDogXCIucGxhbl9fYnV0dG9uLXByZXZcIixcclxuICB9LFxyXG59KTtcclxuXHJcbmlmICh3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDk5MnB4KVwiKS5tYXRjaGVzKSB7XHJcbiAgLy8gQ3VzdG9tIHNjcm9sbGJhclxyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgT3ZlcmxheVNjcm9sbGJhcnMoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImJvZHlcIiksIHsgfSk7XHJcbiAgfSk7XHJcbn0gZWxzZSB7XHJcbiAgLy8gQmVuZWZpdHMgc2xpZGVyXHJcbiAgY29uc3QgYmVuZWZpdHNTbGlkZXIgPSBuZXcgU3dpcGVyKFwiLmJlbmVmaXRzX19zbGlkZXJcIiwge1xyXG4gICAgbG9vcDogZmFsc2UsXHJcbiAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgc3BhY2VCZXR3ZWVuOiAzMCxcclxuICAgIHNwZWVkOiAzMDAsXHJcbiAgICBicmVha3BvaW50czoge1xyXG4gICAgICA3Njg6IHtcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgIGVsOiBcIi5iZW5lZml0c19fcGFnaW5hdGlvblwiLFxyXG4gICAgfSxcclxuICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgbmV4dEVsOiBcIi5iZW5lZml0c19fYnV0dG9uLW5leHRcIixcclxuICAgICAgcHJldkVsOiBcIi5iZW5lZml0c19fYnV0dG9uLXByZXZcIixcclxuICAgIH0sXHJcbiAgfSk7XHJcbn07Il19